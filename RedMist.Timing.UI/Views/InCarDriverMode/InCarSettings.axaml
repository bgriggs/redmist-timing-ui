<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:model="using:RedMist.Timing.UI.ViewModels.InCarDriverMode"
			 xmlns:v="using:RedMist.Timing.UI.Views.InCarDriverMode"
             mc:Ignorable="d" d:DesignWidth="350" d:DesignHeight="450"
             x:Class="RedMist.Timing.UI.Views.InCarDriverMode.InCarSettings"
			 x:DataType="model:InCarSettingsViewModel">
	<Grid>
		<!--Settings-->
		<Grid RowDefinitions="Auto,*,Auto" IsVisible="{Binding !IsPositionsVisible}">
			<!-- Header with background -->
			<Border Background="{DynamicResource TimingTableHeaderBackgroundBrush}" 
					Grid.Row="0" 
					Padding="12,12,12,12"
					BorderBrush="{DynamicResource boldItemBorder}"
					BorderThickness="0,0,0,1">
				<Grid ColumnDefinitions="Auto,*">
					<Button Classes="back" Margin="0,0,12,0" Command="{Binding Back}"/>
					<TextBlock Text="In-Car Driver Settings" Classes="title" Grid.Column="1" VerticalAlignment="Center"/>
				</Grid>
			</Border>

			<!-- Content panel with elevation -->
			<Border Background="{DynamicResource lightAppBackground}" 
					Margin="16,16,16,0" 
					Padding="16" 
					CornerRadius="6" 
					Grid.Row="1"
					BorderBrush="{DynamicResource boldItemBorder}"
					BorderThickness="1"
					BoxShadow="0 2 8 0 #10000000">
				<StackPanel Spacing="12">
					<TextBlock Text="Loading..." IsVisible="{Binding IsLoading}" Classes="title"/>
					<TextBox Text="{Binding CarNumber}" Watermark="Car Number" Width="140" HorizontalAlignment="Left"/>
					<StackPanel Spacing="4">
						<TextBlock Text="Select Event" Classes="tableheader"/>
						<ComboBox ItemsSource="{Binding Events}" SelectedItem="{Binding SelectedEvent}" HorizontalAlignment="Stretch">
							<ComboBox.ItemTemplate>
								<DataTemplate>
									<TextBlock Text="{Binding Name}"/>
								</DataTemplate>
							</ComboBox.ItemTemplate>
						</ComboBox>
					</StackPanel>
					<CheckBox Content="Show in-class cars only" IsChecked="{Binding IsInClassOnly}"/>
					<TextBlock Text="{Binding Message}" 
							   IsVisible="{Binding HasMessage}" 
							   TextWrapping="Wrap" 
							   FontSize="10" 
							   Foreground="{DynamicResource TextTableHeaderForegroundBrush}"
							   Margin="0,8,0,0"/>
				</StackPanel>
			</Border>

			<!-- OK Button with better visibility -->
			<Button Content="OK" 
					Grid.Row="2" 
					Command="{Binding Ok}" 
					HorizontalAlignment="Right" 
					HorizontalContentAlignment="Center"
					Margin="0,12,16,16"
					MinWidth="80"
					Padding="12,6"/>
		</Grid>

		<!-- In-Car Positions View -->
		<ContentControl IsVisible="{Binding IsPositionsVisible}">
			<v:InCarPositions DataContext="{Binding InCarPositionsViewModel}"/>
		</ContentControl>
	</Grid>
</UserControl>
